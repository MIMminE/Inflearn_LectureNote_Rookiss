# Section 1.4 수치와 문자열
## 쿼리에서의 사칙연산



기본적인 사칙연산에 추가적으로 나머지를 구하는 연산까지 가능하다.

```sql
SELECT 2021 - birthYear AS koreaAge
FROM players
WHERE deathYear IS NULL AND birthYear IS NOT NULL 
ORDER BY koreaAge
```

<aside>
💡 **SQL 문의 실행 순서**

위의 코드에서 `WHERE` 절에 `koreaAge`에 대한 조건을 걸어주게 되면 실행되지 않는다. `koreaAge` 필드를 인식하지 못하는 이유인데, 그 아래 `ORDER BY` 절에서는 제대로 동작하고 있다. 

그 이유는 일반적은 프로그래밍 언어처럼 위에서 아래로 명령문들이 실행되는 것이 아니기 때문이다. 

기본적으로 `FROM` → `WHERE` → `SELECT` → `ORDER BY` 순서로 실행된다. 그로 인해 `koreaAge`가 생성되기 이전의 `WHERE` 절에서는 사용할 수 없고, `ORDER BY` 절에서는 사용할 수 있게 된 것이다.

</aside>

NULL 값에 대한 사칙연산을 수행할 경우 해당 연산의 결과는 항상 NULL 값이 되므로 주의해야 한다.

또한 정수끼리의 연산의 결과는 항상 정수가 나오며, 피연산자 중 소수가 하나라도 있다면 결과는 소수로 나온다. 

**(만약 정수끼리의 나눗셈의 결과가 소수라 하더라도 소수점 이하는 버려진다)**

```sql
SELECT 2021 * NULL
-- 결과값 : NULL

SELECT 3/2 
-- 결과값 : 1

SELECT 3/2.0
-- 결과값 : 1.5000

SELECT 3/0 
-- 에러 발생, 0으로 나누는 연산은 대부분 언어에서 허용하지 않음
```

## 함수 사용

---

쿼리 작성에도 사전에 정의된 여러 함수들을 사용할 수 있다. 함수의 종류는 굉장히 많기 때문에 필요할 떄 찾아보며 사용하는 것을 권장한다. **(자주 사용하는 함수들은 자연스럽게 기억하게 될 것이다)**

아래는 대표적인 함수들에 대한 사용법과 결과이다.

- **ROUND** : 소수점을 가진 숫자에 대한 자리올림 자릿수를 정하여 결과를 반환한다.
- POWER : 두 숫자를 입력하여 첫 인자로 준 값에 대한 두번째 인자만큼 거듭제곱한 결과를 반환한다.
- COS : 인자로 준 값에 대한 삼각함수 cos 값을 반환한다.

```sql
SELECT ROUND(3.1414, 3)
-- 결과값 : 3.1410000

SELECT POWER(2, 3)
-- 결과값 : 8

SELECT COS(0)
-- 결과값 : 1
```

T-SQL 함수 관련된 공식문서도 있으니 필요할 때 참고하면 큰 도움이 될 것이다.

## 문자열 연산

---

기본적으로 SQL에서 문자는 1바이트로 처리한다. 즉, 2바이트로 표현되는 한글이나 한자는 표현이 불가능하다. 이를 위해 명시적으로 필드명 또는 문자열 앞에 **`n`** 접두어를 붙여줘야 한다.

```sql
SELECT "hello" 
-- 결과가 제대로 나오지 않음

SELECT n"hello"
-- 결과가 제대로 나옴 (hello)
```

문자열을 붙이는 동작은 표준에서 `CONCAT` 함수를 통해 제공해주고 있다.

하지만 T-SQL에서는 보다 쉬운 방법으로도 가능하다.

```sql
SELECT 'hello ' + 'world'
-- 결과값 : hello world
```

문자열의 특정 구간을 추출하는 기능도 제공한다. 주의할 점은 일반적인 프로그래밍 언어와 달리 인덱스 번호를 1부터 사용한다는 점이다.

```sql
SELECT SUBSTRING('20200425', 1, 4)
-- 결과값 : 2020
-- 첫 번째 문자부터 4개의 문자를 가져온다.
```

문자열 앞뒤의 여백을 제거해주는 기능은 `TRIM` 함수를 통해 제공한다.

```sql
SELECT TRIM('        helloworld')
-- 결과값 : helloworld
```

실제 테이블에서 사용하는 경우에는 아래와 같이 사용할 수 있다.

```sql
SELECT nameFirst + ' ' + nameLast AS fullName
FROM players
WHERE nameFirst IS NOT NULL AND nameLast IS NOT NULL
```

만약 문자열 연산에 사용된 피연산자 필드에 `NULL`이 있으면 결과가 항상 NULL이 되므로 WHERE 절을 통해 조건을 걸어주고 있다.

**(SELECT 문에서 사용한 fullName을 사용하지 못하므로 두 개의 필드를 모두 사용하여 AND 논리연산자를 이용하고 있음을 확인할 수 있다)**

```
인프런 Rookiss 강사님 로드맵 'C#과 유니티로 만드는 MMORPG 게임 개발 시리즈'에 대한 학습을 진행하면서 작성한 개인 기록용 강의노트입니다.
```
