# Section 1.5 DATETIME
## 시계열 데이터

SQL 에서 시계열 데이터를 다루는 타입은 DATE, TIME, DATETIME이 있다. 

- DATE : 연/월/일
- TIME : 시/분/초
- DATETIME : 연/월/일/시/분/초

일반적으로는 `DATETIME` 데이터 타입을 사용하는 편이다. 

DATETIME 타입을 사용하여 작업을 하기 위해서는 해당 타입에 대한 캐스팅 작업이 이루어져야 한다. 

```sql
SELECT CAST('20200425' AS DATETIME)
-- 결과 : 2020-04-25 00:00:00.000
```

결과를 확인해보면 입력되지 않은 시/분/초 부분이 모두 0으로 채워진 것을 확인할 수 있다. 


💡 **DATETIME 입력 포맷**

DATETIME 데이터 타입으로 데이터를 입력할 때, 어느 부분이 년,월,일,시,분,초에 대한 정확한 인지를 위해서 특정 포맷에 맞춰 데이터를 입력해줘야 한다. 여럿 있지만 대표적으로 아래 포맷 중 하나를 선택하면 된다.

- **YYYYMMDD**
- **YYYYMMDD hh:mm:ss:nnn**
- **YYYY-MM-DDThh:mm**


### 현재 시간을 다루는 방법

T-SQL 에서 사용할 수 있는 함수로는 `GETDATE` 함수가 현재 시간에 대한 정보를 반환해준다. 

표준에 따르는 방법으로는 `CURRENT_TIMESTAMP`가 있다. 해당 키워드는 함수가 아니므로 괄호가 필요없다.

```sql
SELECT GETDATE()
SELECT CURRENT_TIMESTAMP

-- 결과값 : 2023-10-20 09:49:01.540
```


💡 로컬 시간대, UTC 시간대

CURRENT_TIMESTAMP 등을 통해 현재 시간을 반환하는 기능을 이용하게 되면 자신의 컴퓨터, 즉 로컬 시간대에 대한 시간이 반환된다. 만약, 다른 국가에서 서비스를 해줘야하는 상황이라면 로컬 시간대를 이용하기는 어렵다. 

현재 날자 및 시간을 전세계 협정 시간대(UTC) 기준으로 반환받고 싶다면 GETUTCDATE 함수를 사용해줘야 한다. 

**(그리니치 표준시(Greenwich Mean Time, GMT)와 동일한 의미를 가지고 있다)**


### 시계열 데이터 입력

시계열 데이터 타입을 필드에 데이터 입력을 해주게 되면 캐스팅을 해주지 않아도 자동으로 시계열 데이터로 인식된다. **(단, 포맷이 맞지 않으면 실패한다)**

```sql
USE [BaseballData]
GO

INSERT INTO [dbo].[dateTiemTest]
           ([time])
     VALUES
           ('2023-10-20 09:49:01.540')
GO
```

해당 입력 포맷은 SSMS 프로그램에서 편의를 위해 제공하는 스크립트 파일에 시계열 데이터만 수정해준 형태이다. **(INSERT INTO 문법은 추후에 자세하게 다룬다)**

### 시계열 데이터 활용

**시계열 데이터는 비교 연산자를 사용하여 조건을 걸수 있다.**

```sql
SELECT *
FROM datetimeTest
WHERE time >= '20200101';

-- 원칙적으로는 CAST('20200101' AS DATETIME)를 사용해야 하지만 
-- 툴에서 자동으로 해주기에 위와 같이 사용해도 무방하다.
```

**시계열 데이터에 대한 덧셈/뺄셈 연산도 가능하다.**

```sql
SELECT DATEADD(YEAR, 1, '20231021')
SELECT DATEADD(DAY, 5, '20231021')
SELECT DATEADD(SECOND, 123123, '20231021')

SELECT DATEADD(SECOND, -123123, '20231021')
```

연산의 결과는 실제 달력을 기준으로 조회된다. 즉, 월을 넘길수도 년을 넘길수도 있다는 말이다.

**입력한 두 시계열 데이터의 차이를 확인하는 기능을 제공해준다.**

```sql
SELECT DATEDIFF(SECOND, '20200101', '20231021')
-- 결과값 : 604800
-- 두 번째 인자에서 세 번째 인자까지의 차이를 반환해준다.
```

**시계열 데이터에 대해 년/월/일 등의 특정 값을 추출하는 기능도 제공해준다.**

```sql
SELECT DATEPART(DAY, '20231021')
-- 결과값 : 21

-- 주로 아래 형태의 축약형을 선호하는 편이다.
SELECT YEAR('20231021')
SELECT MONTH('20231021')
SELECT DAY('20231021')
```
```
인프런 Rookiss 강사님 로드맵 'C#과 유니티로 만드는 MMORPG 게임 개발 시리즈'에 대한 학습을 진행하면서 작성한 개인 기록용 강의노트입니다.
```
